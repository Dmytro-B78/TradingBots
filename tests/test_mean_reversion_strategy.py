# -*- coding: utf-8 -*-# ============================================# ?? File: tests/test_mean_reversion_strategy.py# ?? Р В Р’В Р РЋРЎС™Р В Р’В Р вЂ™Р’В°Р В Р’В Р вЂ™Р’В·Р В Р’В Р В РІР‚В¦Р В Р’В Р вЂ™Р’В°Р В Р Р‹Р Р†Р вЂљР Р‹Р В Р’В Р вЂ™Р’ВµР В Р’В Р В РІР‚В¦Р В Р’В Р РЋРІР‚ВР В Р’В Р вЂ™Р’Вµ: Р В Р’В Р вЂ™Р’В®Р В Р’В Р В РІР‚В¦Р В Р’В Р РЋРІР‚ВР В Р Р‹Р Р†Р вЂљРЎв„ў-Р В Р Р‹Р Р†Р вЂљРЎв„ўР В Р’В Р вЂ™Р’ВµР В Р Р‹Р В РЎвЂњР В Р Р‹Р Р†Р вЂљРЎв„ўР В Р Р‹Р Р†Р вЂљРІвЂћвЂ“ Р В Р’В Р СћРІР‚ВР В Р’В Р вЂ™Р’В»Р В Р Р‹Р В Р РЏ MeanReversionStrategy# ? Р В Р’В Р РЋРЎСџР В Р Р‹Р В РІР‚С™Р В Р’В Р РЋРІР‚СћР В Р’В Р В РІР‚В Р В Р’В Р вЂ™Р’ВµР В Р Р‹Р В РІР‚С™Р В Р Р‹Р В Р РЏР В Р’В Р вЂ™Р’ВµР В Р Р‹Р Р†Р вЂљРЎв„ў Р В Р’В Р РЋРІР‚ВР В Р’В Р В РІР‚В¦Р В Р’В Р СћРІР‚ВР В Р’В Р РЋРІР‚ВР В Р’В Р РЋРІР‚СњР В Р’В Р вЂ™Р’В°Р В Р Р‹Р Р†Р вЂљРЎв„ўР В Р’В Р РЋРІР‚СћР В Р Р‹Р В РІР‚С™Р В Р Р‹Р Р†Р вЂљРІвЂћвЂ“, Р В Р Р‹Р В РЎвЂњР В Р’В Р РЋРІР‚ВР В Р’В Р РЋРІР‚вЂњР В Р’В Р В РІР‚В¦Р В Р’В Р вЂ™Р’В°Р В Р’В Р вЂ™Р’В»Р В Р Р‹Р Р†Р вЂљРІвЂћвЂ“, Р В Р’В Р вЂ™Р’В±Р В Р Р‹Р В Р Р‰Р В Р’В Р РЋРІР‚СњР В Р Р‹Р Р†Р вЂљРЎв„ўР В Р’В Р вЂ™Р’ВµР В Р Р‹Р В РЎвЂњР В Р Р‹Р Р†Р вЂљРЎв„ў Р В Р’В Р РЋРІР‚В summary# ============================================import pytestimport pandas as pdfrom bot_ai.strategy.mean_reversion import MeanReversionStrategy@pytest.fixturedef sample_df():`n    pass    data = {        "timestamp": pd.date_range(start="2026-01-01", periods=30, freq="1h"),        "close": [100 + ((-1)**i) * i for i in range(30)]    }    return pd.DataFrame(data)@pytest.fixturedef config():`n    pass    return {        "sma_fast": 5,        "sma_slow": 10,        "rsi_period": 14    }def test_calculate_indicators_returns_df(sample_df, config):`n    pass    strategy = MeanReversionStrategy(config)    df = strategy.calculate_indicators(sample_df.copy())    assert "sma_fast" in df.columns    assert "sma_slow" in df.columns    assert "rsi" in df.columnsdef test_generate_signals_returns_df(sample_df, config):`n    pass    strategy = MeanReversionStrategy(config)    df = strategy.calculate_indicators(sample_df.copy())    df = strategy.generate_signals(df)    assert "signal" in df.columns    assert df["signal"].isin([-1, 0, 1]).all()def test_backtest_creates_trades(sample_df, config):`n    pass    strategy = MeanReversionStrategy(config)    df = strategy.calculate_indicators(sample_df.copy())    df = strategy.generate_signals(df)    strategy.backtest(df)    assert isinstance(strategy.trades, pd.DataFrame)    assert "timestamp" in strategy.trades.columns    assert "pnl" in strategy.trades.columnsdef test_summary_returns_dataframe(sample_df, config):`n    pass    strategy = MeanReversionStrategy(config)    df = strategy.calculate_indicators(sample_df.copy())    df = strategy.generate_signals(df)    strategy.backtest(df)    summary_df = strategy.summary("BTCUSDT")    assert isinstance(summary_df, pd.DataFrame)    assert set(summary_df.columns) == {"timestamp", "symbol", "pnl"}




