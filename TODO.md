# TODO.md

## 🎯 Цель
Повысить надёжность логирования, расширить тестовое покрытие, автоматизировать контроль и сохранить прозрачную диагностику.

## 📌 Ближайшие задачи (версия 0.4-dev)

1. **Документация**
   - [ ] Добавить раздел «Архитектура селектора пар» в PROJECT_INFO.md
   - [ ] Обновить README.md с кратким описанием модулей селектора

2. **Рефакторинг селектора**
   - [ ] Вынести _safe_ticker и _cache_valid в bot_ai/utils/pipeline_utils.py
   - [ ] Обновить pipeline.py для использования этих утилит
   - [ ] Добавить юнит‑тесты для pipeline_utils.py

3. **Логирование**
   - [ ] Ввести единый префикс для логов фильтров ([FILTER:spread], [FILTER:volume], [FILTER:riskguard], [FILTER:trend])
   - [ ] Добавить отчётность по фильтрам: для каждой пары фиксировать, какие фильтры пройдены/отсечены

4. **Тестовое покрытие**
   - [ ] Расширить test_fetch_and_filter_pairs.py: проверка отчётности по фильтрам
   - [ ] Добавить smoke‑тест на pipeline_utils.safe_ticker
   - [ ] Проверить обратную совместимость: _trend_ok остаётся доступным в pipeline.py

5. **Контроль изменений**
   - [ ] Зафиксировать текущую стабильную версию в git (stage0.3_refactor_selector)
   - [ ] Обновить changes.log с описанием вынесения фильтров и устранения циклического импорта
   - [ ] Сделать snapshot проекта (tests/test_project_state.py)

6. **Исправление упавшего теста**
   - [ ] Выполнить pytest -v и определить, какой тест падает
   - [ ] Проанализировать причину (ошибка логики, данные, окружение)
   - [ ] Исправить код или тест
   - [ ] Обновить PROJECT_INFO.md и changes.log после фикса
   - [ ] Сделать новый snapshot (tests/test_project_state.py)
